import{Q as V}from"./QSpinner-DySJdxf2.js";import{Q as c}from"./QInput-CMMqmE8M.js";import{Q as x}from"./QBtn-BAGuL1f9.js";import{Q}from"./QForm-BMnk-5Pl.js";import{Q as q,a as E}from"./QPage-CoaxcoGq.js";import{s as k,t as P,r as i,v as y,x as d,y as p,z as o,A as m,G as A,B as w,J as v,C as B,K as L,F as S,L as z,_ as D}from"./index-4iD-inBU.js";import{q as I,c as N,d as h,w as U,g as j,s as F,a as $}from"./firebase-CKH9GCJR.js";import"./focus-manager-BJWzFvJg.js";const M={class:"text-center q-mb-md"},W={class:"text-h5 q-mt-sm"},G={key:0,class:"text-negative text-caption q-mt-sm"},J={class:"text-center q-mt-md"},K=k({__name:"LoginPage",setup(R){const f=S(),g=P(),l=i(""),n=i(""),u=i(""),e=i(""),r=i(!1);async function _(){e.value="";try{await L(g,l.value,n.value),await f.push("/")}catch(t){e.value=t instanceof Error?t.message:"Erreur inconnue"}}async function C(){e.value="";try{const t=I(N(h,"users"),U("pseudo","==",u.value)),a=await j(t);if(!u.value){e.value="Le pseudo est requis.";return}if(!l.value||!n.value){e.value="Email et mot de passe requis.";return}if(!u.value.match(/^[a-zA-Z0-9-_]{3,20}$/)){e.value="Le pseudo doit contenir 3 à 20 caractères alphanumériques.";return}if(!l.value.includes("@")){e.value="Format d'email invalide.";return}if(a.size>0){e.value="Ce pseudo est déjà utilisé.";return}const b=(await z(g,l.value,n.value)).user.uid;await F($(h,"users",b),{email:l.value,pseudo:u.value,role:"user",createdAt:new Date}),await f.push("/")}catch(t){t instanceof Error?t.message.includes("auth/email-already-in-use")?e.value="Cet email est déjà utilisé.":e.value=t.message:e.value="Erreur inconnue"}}return(t,a)=>(p(),y(q,{class:"flex flex-center bg-gradient text-white"},{default:d(()=>[o(E,{class:"q-pa-lg shadow-4 bg-white text-dark",style:{width:"400px","border-radius":"16px"}},{default:d(()=>[m("div",M,[o(V,{name:"music_note",size:"48px",class:"text-primary"}),m("h2",W,v(r.value?"Créer un compte":"Connexion"),1)]),o(Q,{onSubmit:a[3]||(a[3]=s=>r.value?C():_()),class:"q-gutter-md"},{default:d(()=>[r.value?(p(),y(c,{key:0,modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=s=>u.value=s),label:"Pseudo",outlined:"",dense:"",color:"primary"},null,8,["modelValue"])):w("",!0),o(c,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value=s),type:"email",label:"Email",outlined:"",dense:"",color:"primary"},null,8,["modelValue"]),o(c,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=s=>n.value=s),type:"password",label:"Mot de passe",outlined:"",dense:"",color:"primary"},null,8,["modelValue"]),m("div",null,[o(x,{type:"submit",label:r.value?"Créer un compte":"Se connecter",color:"primary",class:"full-width"},null,8,["label"])])]),_:1}),e.value?(p(),A("div",G,v(e.value),1)):w("",!0),m("div",J,[o(x,{flat:"",dense:"",size:"sm",onClick:a[4]||(a[4]=s=>r.value=!r.value),class:"text-primary"},{default:d(()=>[B(v(r.value?"← Déjà inscrit ? Se connecter":"Pas encore de compte ? Créer un compte"),1)]),_:1})])]),_:1})]),_:1}))}}),te=D(K,[["__scopeId","data-v-2578134b"]]);export{te as default};
